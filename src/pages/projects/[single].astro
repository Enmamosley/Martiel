---
// Redirección automática de /projects/[proyecto] a /proyectos/[proyecto]
import { getSinglePage } from "../../lib/contentParser.astro";

export async function getStaticPaths() {
  const FOLDER = "projects";
  const projects = await getSinglePage(FOLDER);

  const paths = projects.map((project) => ({
    params: {
      single: project.id,
    },
    props: { project },
  }));
  return paths;
}

const { project } = Astro.props;
const redirectUrl = `/proyectos/${project.id}`;

const response = Astro.response;
response.headers.set('Location', redirectUrl);
response.status = 301;
---

<script define:vars={{ redirectUrl }}>
  // Redirección del lado del cliente como respaldo
  if (typeof window !== 'undefined') {
    window.location.replace(redirectUrl);
  }
</script>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="refresh" content={`0; url=${redirectUrl}`}>
  <title>Redirigiendo...</title>
</head>
<body>
  <p>Si no eres redirigido automáticamente, <a href={redirectUrl}>haz clic aquí</a>.</p>
</body>
</html>
